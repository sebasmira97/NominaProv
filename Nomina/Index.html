<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador JSON N√≥mina Electr√≥nica</title>
    <link rel="stylesheet" href="styles.css">
    <script src="api-config.js" defer></script>
    <script src="main.js" defer></script>
</head>
<body>
    <div class="container">
        <h1>üìÑ Generador JSON N√≥mina Electr√≥nica</h1>
        
        <div class="info-box">
            <h3>üìã Instrucciones</h3>
            <p>Complete los datos para generar un archivo JSON con la estructura exacta requerida para la transmisi√≥n de n√≥mina electr√≥nica. El archivo se descargar√° autom√°ticamente en formato TXT/JSON listo para env√≠o.</p>
        </div>
        
        <!-- Configuraci√≥n General -->
        <div class="section">
            <h2><span class="icon">‚öôÔ∏è</span>Configuraci√≥n General</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="resolutionNumber">N√∫mero de Resoluci√≥n</label>
                    <input type="text" id="resolutionNumber" placeholder="18760000001" value="18760000001">
                </div>
                <div class="form-group">
                    <label for="documentNumber">N√∫mero de Documento</label>
                    <input type="text" id="documentNumber" placeholder="1">
                </div>
                <div class="form-group">
                    <label for="generationCityId">Ciudad de Generaci√≥n</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="text" id="generationCityId" placeholder="Medell√≠n" value="1" style="flex: 1;">
                        <button type="button" onclick="reloadCities()" class="btn-reload" title="Recargar ciudades desde API">
                            üîÑ
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="payDay">Fecha de Pago</label>
                    <input type="date" id="payDay">
                </div>
                <div class="form-group">
                    <label for="generationDate">Fecha de Generaci√≥n</label>
                    <input type="date" id="generationDate">
                </div>
                <div class="form-group">
                    <label for="generationTime">Hora de Generaci√≥n</label>
                    <input type="time" id="generationTime" value="10:00:00">
                </div>
            </div>
        </div>

        <!-- Per√≠odo -->
        <div class="section">
            <h2><span class="icon">üìÖ</span>Informaci√≥n del Per√≠odo</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="dateEntry">
                        Fecha de Ingreso 
                        <span class="info-icon" title="Fecha en que el empleado ingres√≥ a la empresa. Se usa para calcular antig√ºedad y prestaciones sociales.">‚ÑπÔ∏è</span>
                    </label>
                    <input type="date" id="dateEntry">
                </div>
                <div class="form-group">
                    <label for="departureDate">
                        Fecha de Retiro
                        <span class="info-icon" title="Fecha en que el empleado se retir√≥ de la empresa. Importante! Si el empleado aun esta contratado deja este campo sin llenar.">‚ÑπÔ∏è</span>
                    </label>
                    <input type="date" id="departureDate" placeholder="Dejar vac√≠o si est√° activo">
                </div>
                <div class="form-group">
                    <label for="settlementStartDate">Fecha Inicio Liquidaci√≥n</label>
                    <input type="date" id="settlementStartDate">
                </div>
                <div class="form-group">
                    <label for="settlementEndDate">Fecha Fin Liquidaci√≥n</label>
                    <input type="date" id="settlementEndDate">
                </div>
                <div class="form-group">
                    <label for="timeWorked">Tiempo Trabajado (d√≠as)</label>
                    <input type="number" id="timeWorked" placeholder="30" value="30" readonly>
                    <small style="color: #666; font-size: 0.9em;">Se actualiza autom√°ticamente seg√∫n el per√≠odo seleccionado</small>
                </div>
                <div class="form-group">
                    <label for="periodId">Per√≠odo</label>
                    <select id="periodId">
                        <option value="1">Diario (1 d√≠a)</option>
                        <option value="2">Semanal (7 d√≠as)</option>
                        <option value="3">Decenal (10 d√≠as)</option>
                        <option value="4">Quincenal (15 d√≠as)</option>
                        <option value="5" selected>Mensual (30 d√≠as)</option>
                        <option value="6">Otro (acuerdo especial)</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Empleados -->
        <div class="section">
            <h2><span class="icon">üë•</span>Empleado</h2>
            <div id="employeesContainer">
                <div class="employee-section">
                    <!-- Informaci√≥n Personal -->
                    <div class="subsection">
                        <h3>üìã Informaci√≥n Personal</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Tipo de Trabajador</label>
                                <select class="workerTypeId">
                                    <option value="1">Empleado</option>
                                    <option value="2">Trabajador Asociado</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Subtipo de Trabajador</label>
                                <select class="workerSubtypeId">
                                    <option value="1">Dependiente de salario integral</option>
                                    <option value="2" selected>Dependiente de salario no integral</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Tipo de Documento</label>
                                <select class="identityDocumentId">
                                    <option value="1" selected>C√©dula de Ciudadan√≠a</option>
                                    <option value="2">C√©dula de Extranjer√≠a</option>
                                    <option value="3">NIT</option>
                                    <option value="4">Pasaporte</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="documentNumber">
                                    N√∫mero de Documento <span class="required">*</span>
                                </label>
                                <input type="text" class="documentNumber" required placeholder="12345678">
                            </div>
                            
                            <div class="form-group">
                                <label for="firstName">
                                    Primer Nombre <span class="required">*</span>
                                </label>
                                <input type="text" class="firstName" required placeholder="Juan">
                            </div>
                            
                            <div class="form-group">
                                <label for="otherNames">
                                    Segundo Nombre
                                </label>
                                <input type="text" class="otherNames" placeholder="Carlos">
                            </div>
                            
                            <div class="form-group">
                                <label for="firstSurname">
                                    Primer Apellido <span class="required">*</span>
                                </label>
                                <input type="text" class="firstSurname" required placeholder="P√©rez">
                            </div>
                            
                            <div class="form-group">
                                <label for="secondSurname">
                                    Segundo Apellido
                                </label>
                                <input type="text" class="secondSurname" placeholder="Gonz√°lez">
                            </div>

                        </div>
                    </div>

                    <!-- Informaci√≥n Laboral -->
                    <div class="subsection">
                        <h3>üíº Informaci√≥n Laboral</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Pa√≠s de Trabajo</label>
                                <select class="workingCountryId">
                                    <option value="45" selected>Colombia</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="workCityId">Ciudad de Trabajo</label>
                                <div style="display: flex; gap: 10px; align-items: center;">
                                    <input type="text" id="workCityId" class="workCityId" placeholder="Medell√≠n" value="1" style="flex: 1;">
                                    <button type="button" onclick="reloadWorkCities()" class="btn-reload" title="Recargar ciudades desde API">
                                        üîÑ
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>
                                    Direcci√≥n de Trabajo <span class="required">*</span>
                                </label>
                                <input type="text" class="workAddress" required placeholder="Calle 64 #1631 La Capilla">
                            </div>
                            <div class="form-group">
                                <label>Tipo de Contrato</label>
                                <select class="contractTypeId">
                                    <option value="1">T√©rmino indefinido</option>
                                    <option value="2">T√©rmino fijo</option>
                                    <option value="3">Obra o labor</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="salary">
                                    Salario <span class="required">*</span>
                                </label>
                                <input type="number" class="salary" required placeholder="1200000">
                            </div>
                            <div class="form-group">
                                <label for="workerCode">
                                    C√≥digo del Trabajador <span class="required">*</span>
                                </label>
                                <input type="text" class="workerCode" required placeholder="EMP001">
                            </div>
                            <div class="form-group">
                                <label>¬øSalario Integral?</label>
                                <select class="integralSalary">
                                    <option value="false">No</option>
                                    <option value="true">S√≠</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>¬øAlto Riesgo Pensional?</label>
                                <select class="highRiskPension">
                                    <option value="false">No</option>
                                    <option value="true">S√≠</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Informaci√≥n de Pago -->
                    <div class="subsection">
                        <h3>üè¶ Informaci√≥n de Pago</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>M√©todo de Pago</label>
                                <select class="paymentMethodId">
                                    <option value="1" selected>Contado</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Medio de Pago</label>
                                <select class="meansPaymentId">
                                    <option value="10">Efectivo</option>
                                    <option value="31">D√©bito de cuenta corriente</option>
                                    <option value="42" selected>D√©bito de cuenta de ahorros</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="bank">
                                    Banco <span class="required bank-required">*</span>
                                </label>
                                <input type="text" class="bank" required placeholder="Bancolombia">
                            </div>
                            <div class="form-group">
                                <label>Tipo de Cuenta</label>
                                <select class="accountType">
                                    <option value="AHORROS" selected>Ahorros</option>
                                    <option value="CORRIENTE">Corriente</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="accountNumber">
                                    N√∫mero de Cuenta <span class="required account-required">*</span>
                                </label>
                                <input type="text" class="accountNumber" required placeholder="123456789">
                            </div>
                        </div>
                    </div>

                    <!-- Devengados -->
                    <div class="subsection">
                        <h3>üí∞ Devengados</h3>
                        
                        <!-- B√°sico -->
                        <h4>Salario B√°sico</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>D√≠as Trabajados</label>
                                <input type="number" class="workedDays" placeholder="30" value="30">
                            </div>
                            <div class="form-group">
                                <label>Salario Trabajado</label>
                                <input type="number" class="salaryWorked" placeholder="1200000" readonly>
                            </div>
                        </div>

                        <!-- Transporte -->
                        <h4>Auxilio de Transporte</h4>
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>
                                    Auxilio de Transporte
                                    <span class="info-icon" title="El valor colocado en este campo es el que se pago en el periodo seleccionado">‚ÑπÔ∏è</span>
                                </label>
                                <input type="number" class="transportationAssistance">
                            </div>
                            <div class="form-group">
                                <label>Vi√°ticos Manutenci√≥n</label>
                                <input type="number" class="viaticMaintenance" placeholder="0" value="0">
                            </div>
                            <div class="form-group">
                                <label>Vi√°ticos No Salariales</label>
                                <input type="number" class="viaticNonSalary" placeholder="0" value="0">
                            </div>
                        </div>

                        <!-- Otros Conceptos -->
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>Bonificaciones</label>
                                <input type="number" class="bonusPayment" placeholder="0" value="0">
                            </div>
                            <div class="form-group">
                                <label>Comisiones</label>
                                <input type="number" class="commission" placeholder="0" value="0">
                            </div>
                            <div class="form-group">
                                <label>Otros Conceptos Salariales</label>
                                <input type="number" class="conceptS" placeholder="0" value="0">
                            </div>
                        </div>

                        <!-- Horas Extras Diurnas -->
                        <h4>Horas Extras Diurnas (HED)</h4>
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>Cantidad de Horas</label>
                                <input type="number" class="hedAmount" placeholder="0" value="0" min="0" step="1">
                            </div>
                            <div class="form-group">
                                <label>% Recargo</label>
                                <input type="number" class="hedPercentage" placeholder="25" value="25" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Valor a Pagar</label>
                                <input type="number" class="hedPayment" placeholder="0" readonly>
                            </div>
                        </div>

                        <!-- Horas Extras Nocturnas -->
                        <h4>Horas Extras Nocturnas (HEN)</h4>
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>Cantidad de Horas</label>
                                <input type="number" class="henAmount" placeholder="0" value="0" min="0" step="1">
                            </div>
                            <div class="form-group">
                                <label>% Recargo</label>
                                <input type="number" class="henPercentage" placeholder="75" value="75" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Valor a Pagar</label>
                                <input type="number" class="henPayment" placeholder="0" readonly>
                            </div>
                        </div>

                        <!-- Horas Extras Dominicales y Festivos -->
                        <h4>Horas Extras Dominicales y Festivos (HEDF)</h4>
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>Cantidad de Horas</label>
                                <input type="number" class="hedfAmount" placeholder="0" value="0" min="0" step="1">
                            </div>
                            <div class="form-group">
                                <label>% Recargo</label>
                                <input type="number" class="hedfPercentage" placeholder="100" value="100" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Valor a Pagar</label>
                                <input type="number" class="hedfPayment" placeholder="0" readonly>
                            </div>
                        </div>

                        <!-- Horas Recargo Nocturno -->
                        <h4>Horas Recargo Nocturno (HRN)</h4>
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>Cantidad de Horas</label>
                                <input type="number" class="hrnAmount" placeholder="0" value="0" min="0" step="1">
                            </div>
                            <div class="form-group">
                                <label>% Recargo</label>
                                <input type="number" class="hrnPercentage" placeholder="35" value="35" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Valor a Pagar</label>
                                <input type="number" class="hrnPayment" placeholder="0" readonly>
                            </div>
                        </div>

                        <!-- Horas Recargo Dominicales y Festivos -->
                        <h4>Horas Recargo Dominicales y Festivos (HRDF)</h4>
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>Cantidad de Horas</label>
                                <input type="number" class="hrdfAmount" placeholder="0" value="0" min="0" step="1">
                            </div>
                            <div class="form-group">
                                <label>% Recargo</label>
                                <input type="number" class="hrdfPercentage" placeholder="75" value="75" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Valor a Pagar</label>
                                <input type="number" class="hrdfPayment" placeholder="0" readonly>
                            </div>
                        </div>

                        <!-- Horas Extras Nocturnas Dominicales y Festivos -->
                        <h4>Horas Extras Nocturnas Dominicales y Festivos (HENDF)</h4>
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>Cantidad de Horas</label>
                                <input type="number" class="hendfAmount" placeholder="0" value="0" min="0" step="1">
                            </div>
                            <div class="form-group">
                                <label>% Recargo</label>
                                <input type="number" class="hendfPercentage" placeholder="150" value="150" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Valor a Pagar</label>
                                <input type="number" class="hendfPayment" placeholder="0" readonly>
                            </div>
                        </div>

                        <!-- Horas Recargo Nocturno Dominicales y Festivos -->
                        <h4>Horas Recargo Nocturno Dominicales y Festivos (HRNDF)</h4>
                        <div class="form-row-3">
                            <div class="form-group">
                                <label>Cantidad de Horas</label>
                                <input type="number" class="hrndfAmount" placeholder="0" value="0" min="0" step="1">
                            </div>
                            <div class="form-group">
                                <label>% Recargo</label>
                                <input type="number" class="hrndfPercentage" placeholder="110" value="110" min="0" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Valor a Pagar</label>
                                <input type="number" class="hrndfPayment" placeholder="0" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- Deducciones -->
                    <div class="subsection">
                        <h3>‚ûñ Deducciones</h3>
                        <div class="form-row-2">
                            <div class="form-group">
                                <label>% Salud</label>
                                <input type="number" class="healthPercentage" placeholder="4" value="4" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Deducci√≥n Salud</label>
                                <input type="number" class="healthDeduction" placeholder="48000" readonly>
                            </div>
                        </div>
                        <div class="form-row-2">
                            <div class="form-group">
                                <label>% Pensi√≥n</label>
                                <input type="number" class="pensionPercentage" placeholder="4" value="4" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Deducci√≥n Pensi√≥n</label>
                                <input type="number" class="pensionDeduction" placeholder="48000" readonly>
                            </div>
                        </div>
                        <div class="form-row-2">
                            <div class="form-group">
                                <label>Pagos a Terceros</label>
                                <input type="number" class="thirdPartyPay" placeholder="90000" value="0">
                            </div>
                            <div class="form-group">
                                <label>Otras Deducciones</label>
                                <input type="number" class="otherDeduction" placeholder="0" value="0">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resumen de Pagos -->
                <div class="subsection">
                    <h3>üìä Resumen de Liquidaci√≥n</h3>
                    <div class="payment-summary">
                        <div class="summary-card devengados">
                            <h4>üí∞ Devengados</h4>
                            <div class="summary-row">
                                <span>Salario Trabajado:</span>
                                <span class="summary-salaryWorked">$0</span>
                            </div>
                            <div class="summary-row">
                                <span>Horas Extras:</span>
                                <span class="summary-overtime">$0</span>
                            </div>
                            <div class="summary-row">
                                <span>Auxilio Transporte:</span>
                                <span class="summary-transport">$0</span>
                            </div>
                            <div class="summary-row">
                                <span>Otros Conceptos:</span>
                                <span class="summary-others">$0</span>
                            </div>
                            <div class="summary-total">
                                <strong>Total Devengado: <span class="summary-totalEarned">$0</span></strong>
                            </div>
                        </div>

                        <div class="summary-card deducciones">
                            <h4>üìâ Deducciones</h4>
                            <div class="summary-row">
                                <span>Salud (4%):</span>
                                <span class="summary-health">$0</span>
                            </div>
                            <div class="summary-row">
                                <span>Pensi√≥n (4%):</span>
                                <span class="summary-pension">$0</span>
                            </div>
                            <div class="summary-row">
                                <span>Otras Deducciones:</span>
                                <span class="summary-otherDeductions">$0</span>
                            </div>
                            <div class="summary-total">
                                <strong>Total Deducciones: <span class="summary-totalDeductions">$0</span></strong>
                            </div>
                        </div>

                        <div class="summary-card total-final">
                            <h4>üéØ Neto a Pagar</h4>
                            <div class="final-amount">
                                <span class="summary-netPay">$0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vista Previa JSON -->
        <div class="section preview-section">
            <h2><span class="icon">üëÅÔ∏è</span>Vista Previa del JSON</h2>
            <div class="json-preview" id="jsonPreview">
                El JSON se generar√° autom√°ticamente cuando complete los datos...
            </div>
        </div>
        
        <div class="btn-container">
            <button class="btn btn-secondary" onclick="updatePreview()">
                üîÑ Actualizar Vista Previa
            </button>
            <button class="btn" onclick="generateJSON()">
                üíæ Descargar JSON
            </button>
        </div>
    </div>

    
</body>
</html>